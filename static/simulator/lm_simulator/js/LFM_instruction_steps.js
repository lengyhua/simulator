var instruction_step_1 = "Drag and drop the H&amp;E stained kidney sample onto the microscope stage.";
var instruction_step_2 = "Select SETUP &amp; BRIGHTFIELD mode.";
var instruction_step_3 = "Select the Halogen lamp.";
var instruction_step_4 = "To achieve uniform focus and brightness with transmitted light you must ensure that the microscope is Köhler illuminated before you start. If necessary, refer to Concepts in light Microscopy to review the theory. <br>Select the 10X objective.";
var instruction_step_5 = "Focus on the specimen using the slider below the image. Move the slider until you pass the point of focus and then bring it back to focus. This lets you see the point of optimal focus. The edge of the illuminated area may look slightly out of focus.";
var instruction_step_6 = "Close the field diaphragm by sliding the lever all the way to the right. The leaves of diaphragm form an octagonal opening through which the light passes.";
var instruction_step_7 = "Focus the edge of the field diaphragm until it is sharp, by adjusting the condenser focus slider.";
var instruction_step_8 = "If the field diaphragm is off centre, use the two adjusting screws, represented below with the Condenser Positioning controllers, to bring it to the centre of the field of view.";
var instruction_step_9 = "Open the field diaphragm until the leaves are just outside the field of view by sliding the lever to the left.";
var instruction_step_10 = "Remove the right eye piece and look down the empty hole.";
var instruction_step_11 = "Adjust the aperture diaphragm by sliding the Condenser Aperture lever so that the aperture fills approximately 7/8 of the field of view.";
var instruction_step_12 = "Replace the eyepiece.";
var instruction_step_13 = "The microscope is now Köhler illuminated and ready to use for Brightfield imaging. For the best imaging results, Köhler illumination needs to be done for each objective but we will not repeat the process here. <br>To capture a good brightfield image, you need to adjust the white balance. First, using the slide positioning control, move the slide to an area where there is no sample. This acts as a white reference point.";
var instruction_step_14 = "Select the imaging software";
var instruction_step_15 = "In the software, select white balance button";
var instruction_step_16 = "Move the slide back to the sample.";
var instruction_step_17 = "You will now need to set the best exposure time for your sample i.e. how long the camera is being exposed to light. The longer the time, the brighter the image will be. You want to maximise the dynamic range of the camera you are using, while being careful not to over or under saturate your image pixels. Adjust the exposure slider till you reach what looks like the best exposure.";
var instruction_step_18 = "Click on the LUT button. This will show you which pixels are oversaturated (red) and which are undersaturated (blue) alongside a histogram of the dynamic range of the image. <br>Adjust the exposure time to obtain the best dynamic range spread with the fewest over- and under-saturated pixels. <br>Recheck the LUT. When you are satisfied, you can capture your image by selecting 'Capture'. ";
var instruction_step_19 = "Now switch to the 40x objective. We will assume you have completed the Kohler illumination for this objective.";
var instruction_step_20 = " Focus on the specimen using the slider below the image. Move the slider until you pass the point of focus and then bring it back to focus. This lets you see the point of optimal focus.";
var instruction_step_21 = "Select the imaging software";
var instruction_step_22 = "You will now need to set the best exposure time for your sample i.e. how long the camera is being exposed to light. The longer the time, the brighter the image will be. You want to maximise the dynamic range of the camera you are using, while being careful not to over or under saturate your image pixels. Adjust the exposure slider till you reach what looks like the best exposure.";
var instruction_step_23 = "Now click on the LUT button. This will show you which pixels are oversaturated (red) and which are undersaturated (blue) alongside a histogram of the dynamic range of the image. Adjust the exposure time to obtain the best dynamic range spread with the fewest over- and under-saturated pixels. Recheck the LUT. When you are satisfied, you can capture your image by selecting 'Capture'. ";
var instruction_step_24 = "You can now proceed to select other imaging modes. Select Fluorescence.";
var instruction_step_25 = "Switch to mercury lamp.";
var instruction_step_26 = "";
var instruction_step_26_RFP = "The sample is labelled with a red fluorescent dye, which has characteristic excitation and emission spectra. When the fluorophores are excited, the molecules attain higher energy states but soon return to the ground state, emitting light at a longer wavelength.<br> We'll start by inserting the RFP filter.";
var instruction_step_26_GFP = "The sample is labelled with a green fluorescent dye, which has characteristic excitation and emission spectra. When the fluorophores are excited, the molecules attain higher energy states but soon return to the ground state, emitting light at a longer wavelength.<br> Insert now the GFP filter.<br>(pending rewording instruction)";
var instruction_step_26_DAPI = "The sample is labelled with a blue fluorescent dye, which has characteristic excitation and emission spectra. When the fluorophores are excited, the molecules attain higher energy states but soon return to the ground state, emitting light at a longer wavelength.<br> Insert now the DAPI filter.<br>(pending rewording instruction)";
var instruction_step_27 = "With the filter turret in the correct position, the light path now incorporates the appropriate excitation light required for viewing the fluorescence in your sample. As with brightfield, select the imaging software and adjust your exposure so that you collect the maximum dynamic range, without over or understaurating your image. Remember, overexposing your sample can lead to photobleaching.";
var instruction_step_28 = "You will now need to set the best exposure time for your sample. The longer the time, the brighter the image will be but the more you will bleach your fluorescence. You want to make use of the full dynamic range of the camera you are using, while being careful not to over or under saturate your image pixels. Adjust the exposure slider till you reach what looks like the best exposure.";
var instruction_step_29 = "Now click on the LUT button. This will show the oversaturated pixels  in red and the undersaturated pixels in blue alongside a histogram of the dynamic range of the image. Adjust the exposure time to obtain the best dynamic range spread while minimising over and under saturated pixels. Then recheck the LUT. When you are satisfied, you can capture your 2D widefield fluorescent image by clicking 'Capture'";
var instruction_step_30 = "";
var instruction_step_30_RFP = "You can now move on to capture the GFP images.<br><a class='show-overlay' onclick='green_filter10x_fn()' style='color: #4990e2; cursor: pointer; font-weight: 700;'>Insert the blue GFP filter</a>";
var instruction_step_30_GFP = "You can now move on to capture the DAPI images.<br><a class='show-overlay' onclick='blue_filter10x_fn()' style='color: #4990e2; cursor: pointer; font-weight: 700;'>Insert the violet DAPI filter</a>";
var instruction_step_30_DAPI = "On a real microscope, you can overlay the different channels to get a combined image of your sample.<br>Click <a class='show-overlay' onclick='overlay10x_fn()' style='color: #4990e2; cursor: pointer; font-weight: 700;'>HERE</a> to construct an overlay.";
var instruction_step_31 = "Now you can move to a 40x objective to improve the resolution based on the higher NA of the 40X objective. <br>Select the 40X objective.";
var instruction_step_32 = "Select the imaging software";
var instruction_step_33 = "You will need to now optimise your exposure for each of these channels as well, checking your LUT as you go. The exposure times will not be the same as they were for the 10X objective. Perform the same optimisation of this fluorescent channel.";
var instruction_step_34 = "Check your over/undersaturation by selecting the LUT button.<br>When you're happy with your image, you can deselect the LUT button, or go back and change your exposure if your image is over/underexposed.";
var instruction_step_35 = "If you are happy with your image, you can now capture it by clicking 'Capture'.";
var instruction_step_36 = "";
var instruction_step_36_DAPI = "<a class='show-overlay' onclick='green_filter40x_fn()' style='color: #4990e2; cursor: pointer; font-weight: 700;'>Insert the blue GFP filter</a>";
var instruction_step_36_GFP = "<a class='show-overlay' onclick='red_filter40x_fn()' style='color: #4990e2; cursor: pointer; font-weight: 700;'>Insert the green RFP filter</a>";
var instruction_step_36_RFP = "Now overlay the optimised images for DAPI, GFP and RFP to get a combined view of your sample. Click <a class='show-overlay' onclick='overlay40x_fn()' style='color: #4990e2; cursor: pointer; font-weight: 700;'>HERE</a> to construct an overlay.";
var instruction_step_37 = "At this point you might now move to a confocal system if you want to remove any out of focus light or capture 3D scans utilising the z-plane.<br>As you proceed to Confocal mode the control interface changes to the computer screen as you are now using lasers to excite your fluorophores, and will no longer be able to utilise the eyepieces. This change is reflected in the simulator. <br>Select Confocal mode to proceed.";
var instruction_step_38 = "As you switch from fluoresence to confocal mode, the light path changes and a laser or LED light source is activated. You can no longer see the image through the eyepieces on the microscope. You will use the computer screen instead. This change is reflected in the simulator interface.<br><br>The sample is a mouse lymph node labelled with Alexa Fluor 488 (cell nuclei), 568 (CD4+) and 647 (CD8+) tags. Unlike fluorescence, you can choose what colour you use for each channel. In this simulator we show 568 in red, 488 in green and 647 in blue.<br>To see what is happening with the lasers in the confocal section you can watch them on the Light Path diagram.<br><br>The activities from the Activities Menu will take you through the stages involved in using a confocal microscope. We recommend going through them in order but feel free to return and repeat any step later by clicking on the Activities Menu button. <br><br>Click <a class='show-overlay' onclick='LFM_step_39()' style='color: #4990e2; cursor: pointer; font-weight: 700;'>HERE</a> to start";
var instruction_step_39 = "We assume for this confocal section that you have already focused your sample in widefield fluorescence mode using the 10x objective before switching to confocal.<br><br>First, set up your viewing parameters. To see your AF568 label select Channel 3. This corresponds to the correct laser line to excite Alexa Fluor 568 or TRITC. Laser line = 561nm.";
var instruction_step_40 = "First you need to power the detector. This increases the sensitivity of the detector to light, resulting in a brighter image. It also increases the background signal. <br>Do this by moving the Gain slider to  40V.";
var instruction_step_41 = "The laser slider reflects the power of the laser. It is important to ALWAYS use the LOWEST laser power that gives an acceptable image. On this simulator, a setting of 5% is a good starting point to let you see something in your sample. This can be different on different microscopes.<br><br>Turn on the laser by moving the Channel 3 laser slider to a value of 5%.";
var instruction_step_42 = "Set Pinhole to 1.0 AU. The pinhole blocks the out-of-focus light.";
var instruction_step_43 = "Image size is set at this stage so the scanner knows how many pixels to scan. Selecting fewer pixels will scan the image faster and limit the amount of bleaching of your sample. <br><br>Select an Image Size of 512 x 512 pixels.";
var instruction_step_44 = "Click Live View to  start scanning continuously in x–y plane.";
var instruction_step_45 = "Select the Under/Over look-up table (LUT) in the drop down menu.<br><br>The images of the tissue when the Under/Over LUT is selected will be shown in grayscale to distinguish it from the red and cyan pixels that indicate the over and under exposed areas.<br><br>Red = maximum intensity; Cyan = zero (minimum intensity). The image should contain very few red or cyan pixels over the tissue area when it is correctly exposed.";
var instruction_step_46 = "To achieve the best image you need to adjust Laser Power, Gain and Offset. Increasing the Gain will increase the brightness but also the noise. Increasing the laser power will increase the brightness but will also lead to photobleaching and photodamage. On an actual microscope this optimisation is an iterative process. However, for simplicity in this simulation you just step through in order.<br><br>Start by adjusting the Gain. You will see more cyan pixels at lower gain and red pixels start to appear as  you reach the saturation point of the detector. Select the level where there are fewest red and cyan pixels over the sample tissue.";
var instruction_step_47 = "Now adjust the Laser power until the signal is clear and there are minimal red and cyan pixels in your sample area.<br>Remember to select the lowest laser power that gives a good signal.";
var instruction_step_48 = "Adjust the Offset to change the black level. Ideally you will have a few blue pixels. The offset allows you to maximise the dynamic range of your image.";
var instruction_step_49 = "Select Default in the LUT menu. ";
var instruction_step_50 = "Click Live View button to stop scanning.";
var instruction_step_51 = "Change the Image Size to 1024 x 1024 to ensure you capture a higher resolution image. Click the Capture button to collect a single image.";
var instruction_step_52 = "Select the 40x dry NA 0.95 Objective.";
var instruction_step_53 = "Select Channel 3";
var instruction_step_54 = "Set Pinhole to 1.0 AU";
var instruction_step_55 = " Change the  image Size to 512x512  to ensure you are performing a faster scan and minimising the time your sample is exposed to excitation light while you optimise your settings. ";
var instruction_step_56 = "Click Live View to turn on laser and to start scanning continuously in x–y plane.";
var instruction_step_57 = "Move through the focal planes of the sample by moving the Z-position slider to find the brightest focal plane where you can optimise your imaging parameters.";
var instruction_step_58 = "Select the Under/Over LUT drop down.<br>The images of the tissue when the Under/Over LUT is selected will be shown in grayscale to distinguish it from the red and cyan pixels that indicate the over and under exposed areas.<br>Red = maximum intensity; cyan = zero (minimum intensity). You should aim to minimise the number of red and cyan pixels on the area of your sample.";
var instruction_step_59 = "You will need to optimise your image for the new objective. <br>Start by adjusting the Gain. Aim to get minimal red and cyan pixels as you did for the 10x objective.";
var instruction_step_60 = "Adjust the Laser power until the signal is clear and there are minimal red a and cyan pixels in your sample area";
var instruction_step_61 = "Use the Offset slider to adjust the black level. Ideally you will have only a few cyan pixels. The offset allows you to maximise the dynamic range of your image.";
var instruction_step_62 = "Select Default in the LUT menu.";
var instruction_step_63 = "Click Live View button to stop scanning.";
var instruction_step_64 = "Change the Image Size to 1024 x 1024 to ensure you capture a higher resolution image.<br>Click the Capture button to collect a single image.";
var instruction_step_65 = "Reset the size to 512 x 512.<br>Click Live View to turn on laser and start scanning continuously in x,y plane.";
var instruction_step_66 = "Select the Under/Over LUT drop down.<br>Red = maximum intensity; Cyan = zero (minimum intensity).";
var instruction_step_67 = "<br>Click Live View button to stop scanning.";
var instruction_step_68 = "Click the Capture button to collect a single image that shows the optimal dynamic range for the pinhole at 1.0 so you can compare this to other pinhole settings.";
var instruction_step_69 = "Set Pinhole to OPEN ";
var instruction_step_70 = "Without changing any other settings, click the Capture button to collect a single image.";
var instruction_step_71 = "Note how much brighter and blurrier the open pinhole image is and how much data you are loosing based on the number of oversaturated red pixels.";
var instruction_step_72 = "Set Pinhole to 0.4 AU (closed)";
var instruction_step_73 = "Without changing any other settings, click the Capture button to collect a single image.";
var instruction_step_74 = "<br>Select the Default LUT to see the images without the over and undersaturtated pixels.<br>Compare the images that you have just collected. ";
var instruction_step_75 = "Set Pinhole back to 1.0 AU";
var instruction_step_76 = "The current pixel dwell is 4.0µs. Without changing any other settings, click the Capture button to collect a single image.";
var instruction_step_77 = "Change the Pixel Dwell to 2 µsec.";
var instruction_step_78 = "Select the Under/Over LUT drop down.<br>Red = maximum intensity; Cyan = zero (minimum intensity). ";
var instruction_step_79 = "Click Live View to turn on laser and start scanning continuously in x–y plane. <br>Note that the scanning is faster because the laser spends less time on each pixel. The image is also corespondingly dimmer as less light is collected from each pixel.";
var instruction_step_80 = "Click Live View button to stop scanning.";
var instruction_step_81 = "Without changing any other settings, click the Capture button to collect a single image.";
var instruction_step_82 = "Change the Pixel Dwell to 12 µsec.";
var instruction_step_83 = "Without changing any settings, click Live View to turn on laser and start scanning. Note how slowly the laser is scanning and how much brighter the images is.";
var instruction_step_84 = "Click Live View button to stop scanning.";
var instruction_step_85 = "Without changing any other settings, click the Capture button to collect a single image.";
var instruction_step_86 = "Compare the effect of pixel dwell time on signal intensity in the image. Toggle LUT settings between Default and Over/Under to see the difference between having the Over/Under pixels highlighted and the original image.<br>When ready, continue to the Pixel Arrays activity to see how changing the pixel number affects image quality.";
var instruction_step_87 = "Change the Pixel Dwell to 4 µsec, the optimum from the last activity.";
var instruction_step_88 = "Click Live View to turn on laser and start scanning continuously.";
var instruction_step_89 = "Change the Image Size to 1024 x 1024 pixels.";
var instruction_step_90 = "Click Live View button to stop scanning.";
var instruction_step_91 = "See what happens to the image quality as you select different pixel arrays from the drop-down menu. Make your selection, click  ‘Live View’ to start scanning, and use the Zoom slider to see what happens to the image quality as you zoom in. Stop scanning by clicking ‘Live View’ make your next selection and repeat the scanning and zooming process. You can capture images at any stage by stopping the live view and clicking Capture.<br><br>When you have collected all the images, click <a class='show-overlay' onclick='instruction91a_fn()' style='color: #4990e2; cursor: pointer; font-weight: 700;'>HERE</a>.";
var instruction_step_91a = "<b>NOTE:</b> You have seen how changing the pixel array affects your image quality. Keep in mind however, slower scanning speeds like 2048x2048 might lead to photobleaching of your sample. So whilst optimising other parameters, keep your pixel array relatively small to minimise photobleaching. You can always increase the pixel array when you are ready to capture your image.<br><br>You have now completed the Pixel Array activity. <br>Continue to the Multichannel activity to optimise the imaging of other fluorophores in your sample.";
var instruction_step_92 = "Select 512x512 pixel array as a good starting point to start optimising your multichannel image.";
var instruction_step_93 = "Select Simultaneous Scan Mode to activate multiple detectors to simultaneously acquire the fluorescent signal from each of the fluorophores you will be activating in the sample. Each of these fluorophores should be staining a discrete feature in your sample.<br>Ensure Channel 3 is activated to view the AlexaFluor 568 in your sample.";
var instruction_step_94 = "Ensure Channel 3 is activated to view the AlexaFluor 568 in your sample.";
var instruction_step_95 = "We have moved to a new field of view so we don't capture an area that has been photobleached. Click Live View to turn on laser and to start scanning continuously. This time the Gain, Offset and Laser Power for Channel 3 have been optimised for you.<br>Remember, to see what is happening with the lasers in this activity you can watch them on the Light Path diagram.";
var instruction_step_96 = "Click Live View button to stop scanning.";
var instruction_step_97 = "Activate Channel 4 to view the AlexaFluor 647 label.";
var instruction_step_98 = "Click Live View to turn on laser and to start scanning continuously. The the Gain, Offset and Laser Power for Channel 4 have been optimised in the Visualising your image activity.";
var instruction_step_99 = "Click Live View button to stop scanning.";
var instruction_step_100 = " Click 'Capture' to capture this simultaneous image.  Notice the lack of distinction within the blue channel. This is because the Alexa568 is very bright, and it’s emission profile has noticeably bled into channel 4.";
var instruction_step_101 = "To reduce the effects of spectral crosstalk and bleedthrough, select Sequential from the drop down.";
var instruction_step_102 = "You have already optimised channel 3 and channel 4 settings so you can now go ahead and capture a sequentially scanned image. On this setting the two lasers scan each frame alternately, first channel 3, then channel 4.<br><br>Click on the Capture button to collect a two channel sequential image.";
var instruction_step_103 = "Now <a class='show-overlay' onclick='multch_compare_fn()' style='color: #4990e2; cursor: pointer; font-weight: 700;'>COMPARE</a> the results of the simultaneous and sequential scans. <br>Note how much less purple (red and blue in the same pixel) in the sequential compared to the simultaneous image.  This is because by imaging with one laser at a time, we reduce collection of photons excited by the ‘wrong’ laser AND those excited by the ‘right’ laser but that bleed into the ‘wrong” channel.";
var instruction_step_104 = "Now that we have sorted out the spectral overlap issues by switching to a sequential scan, we can now go ahead and optimise our final fluorophore by selecting channel 2. This has been done for you using the same process as above by using the Over/Under LUT to optimise the Gain, Laser and Offset. <br><br>Start scanning the image by clicking the Live View button.";
var instruction_step_105 = "Click Live View button to stop scanning.";
var instruction_step_106 = "Click on the Capture button to collect a 3-channel, sequential image.";
var instruction_step_107 = "Deactivate  Channels 2 and 4 and ensure that channel 3 is activated. Also ensure that the 40x objective is selected. You now set your top and bottom Z parameters so you can capture images of everything in between. <br>Click Live View to turn on laser and to start scanning continuously. Your focal plane will be wherever your region of interest was originally set.";
var instruction_step_108 = "Define the limits for the Z stack. To do this move the Focus to the LOWEST position (closest to 0) where an image is just visible. Press Bottom Z to save the lower limit of the sample.";
var instruction_step_109 = "Move the Focus to the highest position where you can still see any fluorescence. Press Top Z to save the upper limit of the sample.";
var instruction_step_110a = "Optimal z step size can be calculated.  You first calculate the axial resolution (raxial) based on the objective lens numerical aperture (NA), emission wavelength in µm (λ) and refractive index of mounting media (n).<br><br>r_axial=1.4 λn/〖NA〗^2 <br><br>Here, the 40x objective is a dry lens (refractive index of air = n = 1.0) with an NA of 0.75. The emission wavelength is approximately 600nm = 0.6µm.<br><br>r_axial=1.4 (0.6*1.0)/〖0.75〗^2 =1.49μm<br><br>Now that we know the axial resolution, Nyquist Sampling recommends 2.3 steps per axial resolution distance.<br><br>d_(step size)=1.49μm/2.3=  0.65μm"
var instruction_step_110 = "In the Step Size dropdown, select 'optimal'";
var instruction_step_111 = "Click Live View button to stop scanning.";
var instruction_step_112 = "The full thickness of the sample has now been defined and an optimum number of slices (200) has been selected automatically. The optimal Step Size has been calculated by dividing the sample thickness by the number of slices as per Nyquist sampling (as shown in previous step).  In this case it is 0.63µm.<br><br>Press Capture Z-Stack<br><br>Note we have sped up the capture time 3-fold to make this quicker. In real imaging this would scan at the same 1 full scan per 2 seconds since the image size is 512x512 pixels.";
var instruction_step_113 = "View the 3D image of the Z-stack. Note the appearance escpecially when the image is viewed 'side-on' at 180 degrees rotation.<br><br>When ready, close the 3D image to continue.";
var instruction_step_114 = "Often, the highest resolution is not required for all images. One option is to increase the Step Size. This reduces the number of slices and therefore the time required to collect the Z stack. You will now investigate how making the Step Size larger affects the resulting 3D image reconstruction. Note that the gain, offset and laser power settings do not need to be reset<br>Set Step Size to 5.0µm";
var instruction_step_115 = "Press Capture Z-Stack";
var instruction_step_116 = "View the 3D image of the Z-stack collected with a step size of 5µm. Note the appearance escpecially when the image is viewed 'side-on' at 180 degrees rotation.<br><br>When ready, close the 3D image to continue adding in the other channels to generate a 3-channel Z-stack of your tissue.";
var instruction_step_117 = "Activate  Channel 2.";
var instruction_step_118 = "Activate Channel 4.";
var instruction_step_119 = "Press Capture Z-Stack";
var instruction_step_120 = "Rotate the 3D image of the 3-channel Z-stack. <br>Note the dark lines when the image is viewed 'side-on' at 180 degrees rotation - these lines show where there is missing data. We call this Undersampling. <br><br>You have finished the final activity in the confocal mode activity.<br>You can revisit any of the activities by selecting them from the Activities Menu";
